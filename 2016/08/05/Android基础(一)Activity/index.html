<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Android 基础（一）Activity | WinterFell</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Android 基础（一）Activity
原创文章，转载请注明出处
文章目录：
概要
Activity 基础知识；
任务和后退栈；
Activity 启动模式；
Activity 数据共享
Activity 、 FragmentActivity 、ActionBarActivity 、AppCompatActivity联系与区别；
Activity 切换效果；
总结。">
<meta property="og:type" content="article">
<meta property="og:title" content="Android 基础（一）Activity">
<meta property="og:url" content="http://nortonahu.github.io/2016/08/05/Android基础(一)Activity/index.html">
<meta property="og:site_name" content="WinterFell">
<meta property="og:description" content="Android 基础（一）Activity
原创文章，转载请注明出处
文章目录：
概要
Activity 基础知识；
任务和后退栈；
Activity 启动模式；
Activity 数据共享
Activity 、 FragmentActivity 、ActionBarActivity 、AppCompatActivity联系与区别；
Activity 切换效果；
总结。">
<meta property="og:image" content="http://nortonahu.github.io/image/android_activity_lifecycle.png">
<meta property="og:image" content="http://nortonahu.github.io/image/activity2.jpg">
<meta property="og:updated_time" content="2016-08-04T16:02:25.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android 基础（一）Activity">
<meta name="twitter:description" content="Android 基础（一）Activity
原创文章，转载请注明出处
文章目录：
概要
Activity 基础知识；
任务和后退栈；
Activity 启动模式；
Activity 数据共享
Activity 、 FragmentActivity 、ActionBarActivity 、AppCompatActivity联系与区别；
Activity 切换效果；
总结。">
<meta name="twitter:image" content="http://nortonahu.github.io/image/android_activity_lifecycle.png">
  
    <link rel="alternative" href="/atom.xml" title="WinterFell" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/header_image.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Hong Yu</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Winter Is Coming</p>
		

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/categories/技术教程">技术教程</a></li>
				        
							<li><a href="/categories/杂谈">杂谈</a></li>
				        
							<li><a href="/about/index.html">关于</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/NortonAhu" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/yuhongpc/profile?rightmod=1&wvr=6&mod=personinfo" title="weibo">weibo</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/HongYuAhuCN" title="twitter">twitter</a>
					        
						</div>
					</nav>
				</section>
				
				
				
				

				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Hong Yu</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="/img/header_image.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Hong Yu</h1>
			</hgroup>
			
			<p class="header-subtitle">Winter Is Coming</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/categories/技术教程">技术教程</a></li>
		        
					<li><a href="/categories/杂谈">杂谈</a></li>
		        
					<li><a href="/about/index.html">关于</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/NortonAhu" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/yuhongpc/profile?rightmod=1&wvr=6&mod=personinfo" title="weibo">weibo</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/HongYuAhuCN" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-Android基础(一)Activity" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/08/05/Android基础(一)Activity/" class="article-date">
  	<time datetime="2016-08-04T16:02:25.000Z" itemprop="datePublished">2016-08-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Android 基础（一）Activity
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Activity/">Activity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android-基础/">Android 基础</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/技术教程/">技术教程</a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Android-基础（一）Activity"><a href="#Android-基础（一）Activity" class="headerlink" title="Android 基础（一）Activity"></a>Android 基础（一）Activity</h1><p><img src="/image/android_activity_lifecycle.png" alt=""></p>
<p><strong>原创文章，转载请注明出处</strong></p>
<h2 id="文章目录："><a href="#文章目录：" class="headerlink" title="文章目录："></a>文章目录：</h2><ul>
<li>概要</li>
<li>Activity 基础知识；</li>
<li>任务和后退栈；</li>
<li>Activity 启动模式；</li>
<li>Activity 数据共享</li>
<li>Activity 、 FragmentActivity 、ActionBarActivity 、AppCompatActivity联系与区别；</li>
<li>Activity 切换效果；</li>
<li>总结。<a id="more"></a>
<h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2>Activity 作为 Android 四大组件之一(Activity 、ContentProvider 、Service 、 Broadcast) 是我们接触最早可能也是用的最多的一个组件。其实仔细想想我们真的很了解这个组件吗？或者说我们真的使用好了这个组件吗？相信很多人也不能打包票，所以我们就来慢慢研究吧。对上面的 Activity LifeCycle 已经见多不怪，但如果说到 Activity 在任务栈之间存放和以及屏幕切换的重新创建以及单例模式下的数据如果通过 onNewIntent 来改变数据……，综上所述 Activity 是很值得我们深入了解和学习的,下面我们就来分块解析。</li>
</ul>
<h2 id="Activity-基础知识"><a href="#Activity-基础知识" class="headerlink" title="Activity 基础知识"></a>Activity 基础知识</h2><p>Activity 是应用跟用户交互的主要组件，用户的操作主要是在 Activity 上操作的,因此这上面就有了 Activity 生命周期的东西，上面的图是官方 API 提供的应该是最全的生命周期解释了。<br>Activity 在系统中由一个 <em>Activity Stack</em> 栈来管理，打开一个新的 Activity 这个 Activity 就会在这个栈的顶部并且这个 Activity 处在一个运行的状态，之前的 Activity 在栈的位置就会在当前 Activity 下面。这里就有一个问题整个系统就一个 Activity 栈还是每个应用有一个单独栈？这后面在任务和堆栈中会详细介绍我们接着往下看。从上面的生命周期示意图中我们将 Activity 生命划分三个模块。</p>
<ul>
<li>整个生命周期：这个周期是从 <em>onCreate</em> 开始到 <em>onDestory</em> 结束。Activity 会在 onCreate 做好所有的启动工作，而在 onDestory 释放掉所有的资源和对象。例如如果在 Activity 中启动了一个 Thread 来下载数据，这个 Thread 是在 onCreate 中启动在 onDestory 中销毁。</li>
<li>可见生命周期：这个周期是从 <em>onStart</em> 开始到 <em>onStop</em> 结束。在这个阶段用户可以看到这个 Activity ,但是这个用户交互的未必就是这个 Activity 比如 dialog 什么的。在这个时间段里你可以拥有资源来用户进行交互。在这个周期你可以在 onStart 注册广播 (BroadCastReceiver)来接收更新 UI 的消息，并且在 onStop 中解除注册。Activity 一会隐藏一会显示对多次调用这两个方法。不过一般广播会在 onResume 和 onStop 中注册和解绑，下面我们就来说下前台生命周期。</li>
<li>前台生命周期：这个生命周期时间范围是 onResume 开始到 onPause 结束。这个周期是指与用户交互的周期，简单的说用户可操作（获得焦点），onResume 和 onPause 经常被调用，比如说手机锁屏，当传递来一个 Activity 结果。或者是一个新的 intent 到来。关键是最后一句 在这两个方法里处理的东西一定要轻。</li>
</ul>
<p>Activity 生命周期主要由下面的方法，onCreate 开始初始化，onPause 提交状态并且准备结束与用户交互。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Activity</span> <span class="keyword">extends</span> <span class="title">ApplicationContext</span> </span>&#123;</div><div class="line">     <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span></span>;</div><div class="line"></div><div class="line">     <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">     <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onRestart</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">     <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">     <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">     <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">     <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span></span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>下面表格是详细的生命周期介绍;<br><img src="/image/activity2.jpg" alt=""></p>
<p>其中 <strong>killable</strong> 表示在该方法后执行该 Activity 的进程被会被系统在内存不够主动回收掉也就是杀进程。因为这个原因你应该在 onPause 中来记录持续化的数据（例如输入框的数据）。另外  onSaveInstanceState(Bundle) 在 Activity 进入后台时被调用。通过 Bundle 保存 Activity 中动态实例对象。</p>
<h2 id="配置（状态）改变"><a href="#配置（状态）改变" class="headerlink" title="配置（状态）改变"></a>配置（状态）改变</h2><p>这里主要是指设备的状态改变这些信息可以通过 <a href="http://developer.android.com/intl/zh-cn/reference/android/content/res/Configuration.html" target="_blank" rel="external">Resources.Configuration</a>获得。手机设备状态信息的改变就会导致手机的显示的更新然后……。因为 Activity 运行原理就是要与用户进行交互，当手机的设备参数变化时自然就需要支持各种异常的变化。<br>除非你设置了参数配置，否则的话手机设备状态信息改变（横竖屏切换、输入法的弹出……）都会导致 Activity 被销毁然后被重新创建出来。当然他会走正常的生命周期方法。当然 Activity 在前台或者可见的状态下实例会被销毁然会重新创建新的实例，这个过程会加载之前在 onSaveInstanceState(Bundle) 保存的信息。<br>这样做的原因是由于设备的状态改变的时候所有的资源，甚至包括图层文件都会改变。因此最安全保险的方法来应对设备信息变化就是重新查找资源文件（图层、图片、文本信息）。因为 Activity 必须保存当时的状态并且在重新创建的根据状态恢复过来。这样在设备的状态变化的时候 Activity 重新启动就很方便了。<br>在某些特殊的情况，你可能希望通过几种特定的设备状态的变化来重启你的 Activity。这个可以在 Mainiest 文件中 Activity 属性 <em><a href="http://developer.android.com/intl/zh-cn/reference/android/R.attr.html#configChanges" target="_blank" rel="external">android:configChanges</a></em> 属性进行设置。在这个属性里面设置几种状态的变化，这样在 Activity 中  onConfigurationChanged(Configuration) 就会接收到消息而不是重启。如果某些设备的变化并没有声明到这样的话还是会重启 Activity 而且不会在 onConfigurationChanged(Configuration) 调用。</p>
<p>要实现这种状态的变化事件捕获需要以下三步：</p>
<ol>
<li><p>需要在 mainifest 文件增加捕获状态变化的权限：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;uses-permission android:<span class="built_in">name</span>=<span class="string">"android.permission.CHANGE_CONFIGURATION"</span>/&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>在 mainifest 中侦听变化的 Activity 的生命中增加 <em>android:configChanges</em> 属性设置；</p>
</li>
<li>重写 Activity 中 onConfigurationChanged 方法其中的 super 一定不能删除不然就会抛出 android.app.SuperNotCalledException 。</li>
</ol>
<p><em>注意</em><br><strong>1. 旋转频幕的时候 onConfigurationChanged 无法响应的问题？</strong></p>
<p>测试这个 onConfigurationChanged 时发现 Android 4.4.4 系统 无论如何设置横竖屏都无法都调用 onConfigurationChanged，后来参考了网上的一篇文章是由于版本兼容的问题。</p>
<p>自从Android 3.2（API 13），screen size也开始跟着设备的横竖切换而改变。所以，在AndroidManifest.xml里设置的MiniSdkVersion和TargetSdkVersion属性大于等于13的情况下，如果你想阻止程序在运行时重新加载Activity，除了设置”orientation“，你还必须设置”ScreenSize”，就像这样子，android:configChanges=”orientation|screenSize”。但是呢，如果你的Target API 级别小于13，你的Activity自己会自动处理这种ScreenSize的变化。如果你的TargetSdkVersion小于13，即使你在Android 3.2或者更高级别的机器上运行程序，它还是会自己去处理ScreenSize的。</p>
<p><a href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2012/1106/516.html" target="_blank" rel="external">原地址</a></p>
<p><strong>2. 当设置了设备信息的属性再操作也是无法调用 oConfigurationChanged。</strong></p>
<h2 id="启动-Activity-和获取结果"><a href="#启动-Activity-和获取结果" class="headerlink" title="启动 Activity 和获取结果"></a>启动 Activity 和获取结果</h2><p>通过 startActivity(Intent) 方法启动一个新的 Activity ，这个新的 Activity 会在 Activity 栈的顶部。其中唯一的参数 intent 包含了新打开的 Activity 需要的数据，这个比较简单也没啥可说的，后面任务和返回栈也会详细介绍各种启动 Activity 的参数的注意项比如 flag、action 等。</p>
<p>有时当一个 Activity 结束的时候启动这个 Activity 的父 Activity 希望获得一个返回结果，比如我们从手机相册选择一张照片希望在相册 Activity 销毁的同时返回一个图片的路径回来。这就不能使用普通启动 Activity 需要使用 startActivityForResult(Intent, int) 。 前面的 intent 可正常的启动意思是一样都是数据信息的载体，后面的参数是用来表示请求的身份信息的，可能你在一个 Activity 里面有多个请求需要返回的结果就需要这个参数来区别，这个参数叫请求码。父 Activity 中需要重写 protected void onActivityResult (int requestCode, int resultCode, Intent data) 方法来处理返回的数据结果。<br>与请求码对应的结果码，如果是自定义的 Activity 可以通过 setResult(int resultCode) 或者 setResult(int resultCode, Intent data) 来返回结果前者和后者的区别在于有无数据。在刚开始使用时对这两个码不理解导致乱用这两个 code。<br><strong>ResultCode</strong><br>这个返回结果码是有固定值的，一共有三个，可以根据自己的需要增加结果码：<br><figure class="highlight axapta"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** Standard activity result: operation canceled. */</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RESULT_CANCELED    = <span class="number">0</span>;</div><div class="line"><span class="comment">/** Standard activity result: operation succeeded. */</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RESULT_OK           = <span class="number">-1</span>;</div><div class="line"><span class="comment">/** Start of user-defined activity results. */</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RESULT_FIRST_USER   = <span class="number">1</span>;</div></pre></td></tr></table></figure></p>
<p><strong>RequestCode</strong><br>请求码由自己定义区分返回的结果响应</p>
<p>总结，这个两个 code 是组合使用的先试用 RequestCode 确定属于哪一个请求，然后根据 ResultCode 进行结果的判断，成功、取消还是第一个启动者。</p>
<p>具体可以通过例子来说明：<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 打开系统相册</div><div class="line"> */</div><div class="line"><span class="keyword">private</span> <span class="keyword">void</span> openSystemGallery() &#123;</div><div class="line">    Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_PICK, MediaStore.Images.Media.EXTERNAL_CONTENT_URI);</div><div class="line">    startActivityForResult(intent, REQUEST_LOAD_IMAGE);</div><div class="line">&#125;</div><div class="line">@Override</div><div class="line"><span class="keyword">protected</span> <span class="keyword">void</span> onActivityResult(<span class="built_in">int</span> requestCode, <span class="built_in">int</span> resultCode, Intent data) &#123;</div><div class="line">    <span class="keyword">super</span>.onActivityResult(requestCode, resultCode, data);</div><div class="line">    <span class="keyword">switch</span> (requestCode) &#123;</div><div class="line">        <span class="keyword">case</span> REQUEST_LOAD_IMAGE:</div><div class="line">            <span class="keyword">if</span> (resultCode == RESULT_OK &amp;&amp; <span class="keyword">null</span> != data) &#123;</div><div class="line">                Uri selectedImage = data.getData();</div><div class="line">                <span class="keyword">String</span>[] filePathColumn = &#123;MediaStore.Images.Media.DATA&#125;;</div><div class="line"></div><div class="line">                Cursor <span class="built_in">cursor</span> = getContentResolver().query(selectedImage,</div><div class="line">                        filePathColumn, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">                <span class="built_in">cursor</span>.moveToFirst();</div><div class="line"></div><div class="line">                <span class="built_in">int</span> columnIndex = <span class="built_in">cursor</span>.getColumnIndex(filePathColumn[<span class="number">0</span>]);</div><div class="line">                <span class="keyword">String</span> picturePath = <span class="built_in">cursor</span>.getString(columnIndex);</div><div class="line">                <span class="built_in">cursor</span>.close();</div><div class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"选择的照片是"</span> + picturePath, Toast.LENGTH_SHORT).show();</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"发生错误"</span>, Toast.LENGTH_SHORT).show();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> REQUEST_ACTIVITY_2:</div><div class="line">            <span class="keyword">if</span> (resultCode == RESULT_OK) &#123;</div><div class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"成功"</span>, Toast.LENGTH_SHORT).show();</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"失败"</span>, Toast.LENGTH_SHORT).show();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="保存持久化状态"><a href="#保存持久化状态" class="headerlink" title="保存持久化状态"></a>保存持久化状态</h2><p>用于的界面操作主要就是 Activity 之间的切换，如果保存用户的数据就显得比较重要了。通常情况下我们会遇到两种持久化状态需要保存。</p>
<ul>
<li>共享的文本数据（例如 ContentProvider 提供的 SQlite 存储的数据上）；</li>
<li>内部状态（用户设置的选项什么的）</li>
</ul>
<p>对于这一种来说，官方建议使用「edit in place」的用户模式意思是只要用户输入有效的数据就立马保存而不需要询问是否确认，这种模式也有两个简单的规则;</p>
<ul>
<li>当创建新的文本时，关于这个文本的数据库行或者文件立即被创建。例如当用户选择写一封新的邮件时，在输入数据时关于这项邮件栏就已经创立了。</li>
<li>当 Activity 的 onPause 方法被调用时所有有关用户的数据和操作就被保存下来。</li>
</ul>
<p>注意的是当用户选择 <strong>Back</strong> 时并不意味这取消这次操作而是要求保存当前页的数据，如果取消的话应该提供给用户提示信息，比如回顾或者撤销字样。</p>
<p>第二种主要是轻量级的用户选项数据保存。通过 <em>getPreferences(int)</em> 来查询键值对值。用户偏好数据在应用各个组件中都是共享的。可以使用 <em>Context.getSharedPreferences()</em> 特殊 KEY 值查询用户偏好设置数据信息（这种方式不适合应用之间的数据共享，建议使用 content provider）。</p>
<p>下面是用户选择日历显示的一种模式设置。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CalendarActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line">    ...</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DAY_VIEW_MODE = <span class="number">0</span>;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> WEEK_VIEW_MODE = <span class="number">1</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> SharedPreferences mPrefs;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mCurViewMode;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line"></div><div class="line">        SharedPreferences mPrefs = getSharedPreferences();</div><div class="line">        mCurViewMode = mPrefs.getInt(<span class="string">"view_mode"</span>, DAY_VIEW_MODE);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onPause();</div><div class="line"></div><div class="line">        SharedPreferences.Editor ed = mPrefs.edit();</div><div class="line">        ed.putInt(<span class="string">"view_mode"</span>, mCurViewMode);</div><div class="line">        ed.commit();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>单元小结，Activity 的基础知识主要是了解它的生命周期。虽然状态比较多而且很多状态都是属于过度状态，但是其中的 onResume（ Activity 处于栈顶状态时 Active/Running 可以与用户交互） 、 onPause（Activity 失去焦点，对于用户来说是可见不可交互） 、 onStop（已经处于不可见状态而且不在栈顶在后台运行） 却是属于常驻状态，因此生命周期可以分为三大块：</p>
<ul>
<li>启动与销毁：onCreate ~ onPause 、 onStop ~ onDestory，其中 onCreate 创建 UI 基本元素，onPause 和 onStop 清除 Activity 的资源，最后的 onDestory 引用资源会被销毁，但是线程不会，所以需要清理线程。</li>
</ul>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/08/05/Android 动画知识总结篇/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          Android 动画知识总结篇
        
      </div>
    </a>
  
  
    <a href="/2016/08/05/Android备忘录/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Android 备忘录</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>






<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="Android基础(一)Activity" data-title="Android 基础（一）Activity" data-url="http://nortonahu.github.io/2016/08/05/Android基础(一)Activity/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Hong Yu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>